---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  image?: ImageMetadata | string;
  alt?: string;
  title: string;
  subtitle?: string;
  tagline?: string;
  height?: 'xsmall' | 'small' | 'medium' | 'large';
  overlay?: 'dark' | 'gradient' | 'gradient-bottom';
  align?: 'center' | 'bottom';
  bg?: 'sage' | 'sage-dark' | 'terracotta' | 'earth' | 'dark';
}

const {
  image,
  alt = '',
  title,
  subtitle,
  tagline,
  height = 'medium',
  overlay = 'dark',
  align = 'center',
  bg
} = Astro.props;

const hasImage = !!image;

const heightClasses = {
  xsmall: 'h-48 md:h-56',
  small: 'h-64 md:h-80',
  medium: 'h-80 md:h-96',
  large: 'h-96 md:h-[28rem]'
};

const overlayClasses = {
  dark: 'bg-beaucharme-dark/50',
  gradient: 'bg-gradient-to-t from-beaucharme-dark/80 via-beaucharme-dark/40 to-transparent',
  'gradient-bottom': 'bg-gradient-to-t from-beaucharme-dark/80 via-beaucharme-dark/30 to-transparent'
};

const bgClasses = {
  sage: 'bg-beaucharme-sage',
  'sage-dark': 'bg-beaucharme-sage-dark',
  terracotta: 'bg-beaucharme-terracotta',
  earth: 'bg-beaucharme-earth',
  dark: 'bg-beaucharme-dark'
};

const alignClasses = {
  center: 'items-center justify-center',
  bottom: 'items-end'
};

const textAlignClasses = {
  center: 'text-center',
  bottom: 'pb-12 md:pb-20'
};

// Check if image is imported or a string URL
const isImportedImage = image && typeof image !== 'string';
---

<section class:list={[
  "relative flex overflow-hidden rounded-2xl shadow-md",
  heightClasses[height],
  alignClasses[align],
  !hasImage && bg && bgClasses[bg]
]}>
  {hasImage && (
    <div class="absolute inset-0 z-0">
      {isImportedImage ? (
        <Image
          src={image as ImageMetadata}
          alt={alt}
          width={1920}
          height={1080}
          class="w-full h-full object-cover"
        />
      ) : (
        <img
          src={image as string}
          alt={alt}
          width={1920}
          height={1080}
          class="w-full h-full object-cover"
        />
      )}
      <div class:list={["absolute inset-0", overlayClasses[overlay]]}></div>
    </div>
  )}

  <div class:list={["container-custom relative z-10 text-white", textAlignClasses[align]]} data-animate="fade-up">
    {tagline && (
      <p class="text-sm tracking-[0.3em] uppercase mb-4 text-beaucharme-cream/80">{tagline}</p>
    )}
    <h1 class="font-serif text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6">
      {title}
    </h1>
    {subtitle && (
      <p class="text-lg md:text-xl max-w-2xl text-beaucharme-cream/90" class:list={[align === 'center' && 'mx-auto']}>
        {subtitle}
      </p>
    )}
    <slot />
  </div>
</section>
